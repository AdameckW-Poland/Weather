<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>DIAGNOSTYKA RADZIONKÓW - FIX</title>
    <style>
        body { background: #000; color: #00ff00; font-family: monospace; padding: 20px; font-size: 18px; }
        .log { margin-top: 20px; border-top: 1px solid #00ff00; padding-top: 10px; font-size: 14px; }
        .big { font-size: 48px; color: #fff; margin: 20px 0; }
    </style>
</head>
<body>
    <div>STACJA: RADZIONKÓW</div>
    <div id="clock">00:00:00</div>
    <div class="big" id="temp">CZEKAM NA DANE...</div>
    <div id="desc">---</div>
    
    <div class="log" id="console">
        LOGI SYSTEMOWE:<br>
        [1] Skrypt uruchomiony...<br>
    </div>

    <script>
        function log(msg) {
            const c = document.getElementById('console');
            c.innerHTML += `> ${msg}<br>`;
        }

        async function update() {
            log("Próba bezpośredniego pobrania danych z MET Norway...");
            // Usunięto corsproxy.io na rzecz bezpośredniego zapytania
            const target = "https://api.met.no/weatherapi/locationforecast/2.0/complete?lat=50.39&lon=18.90";

            try {
                const response = await fetch(target, {
                    headers: {
                        // Dodano wymagany nagłówek User-Agent dla stabilności połączenia
                        'User-Agent': 'RadzionkowWeatherDiagnostics/1.0'
                    }
                });
                
                log(`Status odpowiedzi: ${response.status}`);
                
                if (!response.ok) throw new Error(`Błąd serwera: ${response.status}`);

                const data = await response.json();
                log("Dane odebrane pomyślnie. Parsowanie...");
                
                const inst = data.properties.timeseries[0].data.instant.details;
                const sym = data.properties.timeseries[0].data.next_1_hours.summary.symbol_code;

                // Wyświetlanie zaokrąglonej temperatury i kodu symbolu pogody
                document.getElementById('temp').innerText = Math.round(inst.air_temperature) + "°C";
                document.getElementById('desc').innerText = "POGODA: " + sym.toUpperCase();
                log("SUKCES: Dane wyświetlone.");
            } catch (e) {
                log(`BŁĄD KRYTYCZNY: ${e.message}`);
                document.getElementById('temp').innerText = "BŁĄD";
            }
        }

        function clock() {
            document.getElementById('clock').innerText = new Date().toLocaleTimeString();
        }

        setInterval(clock, 1000);
        setInterval(update, 600000); // Odświeżanie co 10 minut
        clock();
        update();
    </script>
</body>
</html>
